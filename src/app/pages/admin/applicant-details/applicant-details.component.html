<div class="container" *ngIf="applicantDetails">

  <div class="header d-flex align-items-center">
    <button (click)="goBack()" class="back-button">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h2 class="m-l-12">Application Details</h2>
  </div>
  <mat-card class="cardWithShadow">
    <mat-card-header>
      <mat-card-title class="d-flex align-items-center gap-6">
        Application Status
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="status-controls">
        <div class="current-status">
          <label>Current Status:</label>
          <span class="status-badge" [ngClass]="applicantDetails.status?.toLowerCase()">
            {{applicantDetails.status}}
          </span>
        </div>
        <div class="status-change">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Change Status</mat-label>
            <mat-select [(ngModel)]="selectedStatus">
              <mat-option value="">Select Status</mat-option>
              <mat-option *ngFor="let status of statusOptions" [value]="status">
                {{ status }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <div class="row">
    <div class="col-lg-6">
      <mat-card class="cardWithShadow">
        <mat-card-header>
          <mat-card-title class="d-flex align-items-center gap-6">
            Personal Information
          </mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Name:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.first_name}}
                {{applicantDetails.user.userProfile?.last_name}}</strong></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Email:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.email}}</strong></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Gender:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.gender}}</strong></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Date of Birth:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.dob | date}}</strong></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Mobile:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.mobile}}</strong></div>
          </div>

        </mat-card-content>
      </mat-card>
    </div>
    <div class="col-lg-6">
      <mat-card class="cardWithShadow">
        <mat-card-header>
          <mat-card-title class="d-flex align-items-center gap-6">
            Professional Details
          </mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Current Company:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.current_company}}</strong></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Work Experience:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.work_experiences}}</strong></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Expected Salary:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.work_experiences}}</strong></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Key Skills:</label></div>
            <div class="col-lg-8"> <span class="skill-tag" *ngFor="let skill of keySkills">{{skill}}</span></div>
          </div>
          <div class="row m-b-16">
            <div class="col-lg-4"> <label>Mobile:</label></div>
            <div class="col-lg-8"><strong>--</strong>
                </div>
          </div>

        </mat-card-content>
      </mat-card>
    </div>
    <div class="col-lg-6" *ngIf="applicantDetails.additional_info || applicantDetails.description">
      <mat-card class="cardWithShadow">
        <mat-card-header>
          <mat-card-title class="d-flex align-items-center gap-6">
            Additional Information
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="row m-b-16" *ngIf="applicantDetails.description">
            <div class="col-lg-4"> <label>Description</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.user.userProfile?.current_company}}</strong></div>
          </div>
          <div class="row m-b-16" *ngIf="applicantDetails.additional_info">
            <div class="col-lg-4"> <label>Additional Info:</label></div>
            <div class="col-lg-8"> <strong>{{applicantDetails.additional_info}}</strong></div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="col-lg-6" *ngIf="certifications.length > 0">
      <mat-card class="cardWithShadow">
        <mat-card-header>
          <mat-card-title class="d-flex align-items-center gap-6">
            Courses & Certifications
          </mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="certification-item" *ngFor="let cert of certifications">
            <h4>{{cert.organization_name}}</h4>
            <div class="cert-details">
              <p><strong>Description:</strong> {{cert.certification_description}}</p>
              <a *ngIf="cert.certification_file" [href]="cert.certification_file" target="_blank"
                class="cert-file-link">
                <i class="fas fa-file-pdf"></i> View Certificate
              </a>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="col-lg-6">
      <mat-card class="cardWithShadow">
        <mat-card-header>
          <mat-card-title class="d-flex align-items-center gap-6">
            Documents
          </mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="document-item" *ngIf="applicantDetails.cv_path">
            <i class="fas fa-file-pdf"></i>
            <span>CV/Resume</span>
            <a [href]="applicantDetails.cv_path" target="_blank" class="btn btn-primary btn-sm">
              <i class="fas fa-download"></i> Download CV
            </a>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="col-lg-6" *ngIf="applicantDetails.additional_info || applicantDetails.description">
      <mat-card class="cardWithShadow">
        <mat-card-header>
          <mat-card-title class="d-flex align-items-center gap-6">
            Additional Information
          </mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="row m-b-16" *ngIf="applicantDetails.description">
            <div class="col-lg-12"> <label>Description:</label></div>
            <div class="col-lg-12"> <strong>{{applicantDetails.description}}</strong></div>
          </div>
          <div class="row m-b-16" *ngIf="applicantDetails.additional_info">
            <div class="col-lg-12"> <label>Additional Info:</label></div>
            <div class="col-lg-12"> <strong>{{applicantDetails.additional_info}}</strong></div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="col-lg-6">
      <mat-card class="cardWithShadow">
        <mat-card-header>
          <mat-card-title class="d-flex align-items-center gap-6">
            Admin Comment
          </mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div class="comments-section">
            <textarea [(ngModel)]="adminComments" class="comments-input" placeholder="Add your comments here..."
              rows="3"></textarea>
            <button mat-flat-button (click)="updateStatus()" color="primary">
             Save
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
