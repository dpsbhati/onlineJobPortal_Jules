<!-- Filters -->
<mat-card class="cardWithShadow">
    <mat-card-content>
        <div class="row justify-content-between align-items-center">
            <div class="col-xl-4 col-lg-4 col-md-12">
                <mat-form-field appearance="outline">
                    <mat-label>Search</mat-label>
                    <input matInput [(ngModel)]="filters.all" (keyup.enter)="onSearch()" placeholder="Search..." />
                    <mat-icon matSuffix>search</mat-icon>
                </mat-form-field>
            </div>
            <div class="col-xl-8 col-lg-8 col-md-12">
                <div class="row align-items-center">
                    <div class="col-xl-1 col-lg-1 col-md-12">
                        <h4 class="mb-20"> Filters </h4>
                    </div>
                    <div class="col-xl-3 col-lg-3 col-md-3">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Vessel Type</mat-label>
                            <mat-select [(ngModel)]="filters.vessel_type" (selectionChange)="onSearch()">
                               <mat-option value="">Select Vessel </mat-option>
            <mat-option value="Type 1">Type 1</mat-option>
            <mat-option value="Type 3">Type 3</mat-option>
            <mat-option value="Bulk Carrier">Bulk Carrier</mat-option>
             <mat-option value="Container">Container</mat-option>
                            </mat-select>
                            <button *ngIf="filters.vessel_type" matSuffix mat-icon-button aria-label="Clear"
                                (click)="clearFilter($event, 'vessel_type')">
                                <mat-icon>clear</mat-icon>
                            </button>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-3 col-lg-3 col-md-3">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Rank</mat-label>
                            <mat-select [(ngModel)]="filters.rank" (selectionChange)="onSearch()">
                                <mat-option *ngFor="let rank of uniqueRanks" [value]="rank">
                                    {{ rank }}
                                </mat-option>
                            </mat-select>
                            <button *ngIf="filters.rank" matSuffix mat-icon-button aria-label="Clear"
                                (click)="clearFilter($event, 'rank')">
                                <mat-icon>clear</mat-icon>
                            </button>
                        </mat-form-field>
                    </div>
                    <div class="col-xl-1 col-lg-2 col-md-3">
                        <button mat-button color="primary" class="mb-20" (click)="clearSearch()">
                            Clear
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </mat-card-content>
</mat-card>

<mat-card class="cardWithShadow">
    <mat-card-content>
        <div class="table-responsive">
            <!-- Table -->
            <table mat-table [dataSource]="jobPostingList" matSort class="mat-elevation-z8">
                <!-- Position Column -->
                <ng-container matColumnDef="position">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>#</th>
                    <td mat-cell *matCellDef="let element; let i = index">
                        {{(pageConfig.curPage - 1) * pageConfig.perPage + i + 1}}
                    </td>
                </ng-container>
                <!-- Title Column -->
                <ng-container matColumnDef="title">
                    <th mat-header-cell *matHeaderCellDef>Rank</th>
                    <td mat-cell *matCellDef="let element">{{element.rank}}</td>
                </ng-container>

                <!-- Job Type Column -->
                <ng-container matColumnDef="job_type">
                    <th mat-header-cell *matHeaderCellDef>Vessel Type</th>
                    <td mat-cell *matCellDef="let element">{{element.vessel_type}}</td>
                </ng-container>

                <!-- Employer Column -->
                <ng-container matColumnDef="employer">
                    <th mat-header-cell *matHeaderCellDef>Employer</th>
                    <td mat-cell *matCellDef="let element">{{element.employer}}</td>
                </ng-container>

                <!-- Salary Column -->
                <ng-container matColumnDef="salary">
                    <th mat-header-cell *matHeaderCellDef>Salary</th>
                    <td mat-cell *matCellDef="let element">
                        {{formatSalary(element.start_salary)}}
                    </td>
                </ng-container>

                <!-- Date Published Column -->
                <ng-container matColumnDef="date_published">
                    <th mat-header-cell *matHeaderCellDef>Published Date</th>
                    <td mat-cell *matCellDef="let element">{{element.date_published | date:'mediumDate'}}</td>
                </ng-container>

                <!-- Deadline Column -->
                <ng-container matColumnDef="deadline">
                    <th mat-header-cell *matHeaderCellDef>Deadline</th>
                    <td mat-cell *matCellDef="let element">{{element.deadline | date:'mediumDate'}}</td>
                </ng-container>

                <!-- Number of Applicant Column -->
                <ng-container matColumnDef="number_of_applicant">
                    <th mat-header-cell *matHeaderCellDef>Application Count</th>
                    <td mat-cell *matCellDef="let element">
                        {{element.applicant_number}}
                    </td>
                </ng-container>

                <!-- Status Column -->
                <ng-container matColumnDef="status" *ngIf="isAdmin()">
                    <th mat-header-cell *matHeaderCellDef>Status</th>
                    <td mat-cell *matCellDef="let element">
                        <span
                            class="status rounded-pill f-w-500 p-x-10 p-y-2 f-s-12 ng-star-inserted bg-light-error  text-error">
                            {{element.job_opening | titlecase}}
                        </span>
                    </td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>Action</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button [matMenuTriggerFor]="menu">
                            <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #menu="matMenu">
                            <button mat-menu-item (click)="viewJobPostDetails(element.id)">
                                <mat-icon>visibility</mat-icon>
                                <span>View Details</span>
                            </button>
                            <a mat-menu-item href="/applications">
                                <mat-icon>visibility</mat-icon>
                                <span>View Application</span>
                            </a>
                            <button mat-menu-item (click)="editJob(element.id)" *ngIf="isAdmin()">
                                <mat-icon>edit</mat-icon>
                                Edit
                            </button>
                            <button mat-menu-item (click)="deleteJob(element.id)" *ngIf="isAdmin()">
                                <mat-icon>delete</mat-icon>
                                Delete
                            </button>
                        </mat-menu>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell text-center" [attr.colspan]="displayedColumns.length">
                        <div class="no-records-message">
                            <span class="text-danger ms-2">No records found</span>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <!-- Pagination -->
        <mat-paginator [length]="total" [pageSize]="pageConfig.perPage" [pageIndex]="pageConfig.curPage - 1"
            [pageSizeOptions]="[5, 10, 20, 50, 100]" [showFirstLastButtons]="true" (page)="onPageChange($event)"
            aria-label="Select page">
        </mat-paginator>
    </mat-card-content>
</mat-card>
